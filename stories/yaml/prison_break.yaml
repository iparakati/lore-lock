title: "Prison Break"
author: "Lore Lock"
purpose: "Demonstrate a complete escape room scenario involving puzzles (pushable slab), hidden items (shiv), containment (box), NPC interaction (guard), and lockable doors."

scenes:
  - id: "Damp Stone Cell"
    name: "Damp Stone Cell"
    description: "You wake up on a hard Stone Slab in a damp stone cell. The air is cold. The slab looks uneven."
    contents:
      - id: "stone slab"
        kind: "supporter"
        name: "Stone Slab"
        aliases: ["slab"]
        description: "A cracked stone slab. It looks like it could be shifted."
        properties: { fixed: true, enterable: true }
        interactions:
          - verb: "push"
            type: "before"
            condition: "items['rusty shiv'].location_id == 'off-stage'"
            message: "You shift the heavy stone slab. Underneath, you discover a rusty shiv!"
            actions:
              - { type: "move", target: "rusty shiv", destination: "current_location" }

      - id: "moldy box"
        kind: "container"
        name: "moldy box"
        aliases: ["box"]
        description: "A rotting wooden box."
        properties: { open: false, transparent: false }
        contents:
          - id: "crumpled note"
            kind: "thing"
            name: "crumpled note"
            aliases: ["note", "paper"]
            description: "A scrap of paper. It reads: 'They never check under the slab.'"

      - id: "guard"
        kind: "person"
        name: "Guard"
        description: "A bored guard stands outside the bars. He looks like he might talk about the prison, food, or his boredom."
        topics:
            "freedom": "Hah! You'll rot here."
            "food": "No soup for you."
            "release": "I cannot let you go. It is against protocol."
            "boredom": "Yeah, it's dull. But at least I'm not in there."
            "prison": "It's the safest place for scum like you."
            "slab": "Don't get any ideas about that slab."
            "box": "Just some old junk."
            "shiv": "What shiv? You better not have a weapon!"
            "key": "The key stays with me... mostly."
            "work": "Long shifts. Little pay. But I hold the keys."
            "schedule": "I'm here all day. Don't think about trying anything."

    exits:
      north:
        target: "Corridor"
        door: "iron bars"

  - id: "Corridor"
    name: "The Corridor"
    description: "The cool air of the corridor hits your face. You are free from the damp cell!"
    exits:
      south:
        target: "Damp Stone Cell"
        door: "iron bars"

off_stage:
  - id: "rusty shiv"
    name: "rusty shiv"
    aliases: ["shiv"]
    description: "A jagged piece of metal."

doors:
  - id: "iron bars"
    name: "iron bars"
    aliases: ["bars", "lock"]
    description: "Thick iron bars with a heavy lock."
    locked: true
    key: "rusty shiv"
    interactions:
      - verb: "unlock"
        type: "after"
        message: "With a satisfying click, the heavy lock tumbles open. The path to freedom is clear!"

start_room: "Damp Stone Cell"

test_sequence:
  - "look"
  - "examine slab"
  - "push slab"
  - "take shiv"
  - "open box"
  - "put shiv in box"
  - "close box"
  - "look"
  - "open box"
  - "take shiv"
  - "ask guard about freedom"
  - "unlock bars with shiv"
  - "open bars"
  - "north"
  - "look"

win_condition:
  type: "location"
  target: "Corridor"
